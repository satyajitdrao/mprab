%% Mycobacterium tuberculosis data for response to SDS
% first data set: 
% A. time-course data:
% 1. sigE sds up - wt(2), delta mprA
% 2. mprA sds up - wt, delta sigE
% 3. sigB sds up - wt(3), delta (sigE, mprA, clgR)
% 4. sigE sds down - wt
% B. Dose response
% 1. sigE inc, dec
%  time | set1 | set2 | set3
% transcript - activation/deactivation - strain
% 1. sigE - activation - wild type
wt_up_E = [0	0.000473704	0.000329132	0.000457534
        30	0.002475189	0.002409674	0.00242613
        60	0.002292269	0.002002011	0.002204748
        120	0.002219553	0.0017935	0.001735838
        300	0.002903768	0.003317744	0.002352584];
% 2. sigE - deactivation - wildtype    
wt_down_E = [0	0.002219553	0.0017935	0.001735838
            30	0.000567751	0.000495423	0.00073302
            60	0.000468052	0.000355821	0.00069907
            120	0.000493151	0.000650515	0.000395983
            300	0.000560071	0.000348454	0.000662255];
        
% 3. sigE - activation - wildtype + delta mprA
        % wildtype
sigE_wt = [0	mean([0.000101931	0.00029936	0.000245818])
            30	mean([0.00112947	0.001673808	0.001365462])
            60	mean([0.001528448	0.001339354	0.00105518])
            90	mean([0.001010565	0.001486763	0.001873596])
            120	mean([0.001644416	0.000844133	0.00089731])
            180	mean([0.001000702	0.001444277	0.001045441])
            240	mean([0.000914389	0.001168057	])
            360	mean([0.001018242	0.001271678	0.000759603])
            ];
        sigE_wt_std = [var([0.000101931	0.00029936	0.000245818])
            var([0.00112947	0.001673808	0.001365462])
            var([0.001528448	0.001339354	0.00105518])
            var([0.001010565	0.001486763	0.001873596])
            var([0.001644416	0.000844133	0.00089731])
            var([0.001000702	0.001444277	0.001045441])
            var([0.000914389	0.001168057	])
            var([0.001018242	0.001271678	0.000759603])
            ].^0.5;
        % delta mprA
sigE_delmprA = [0	mean([0.000138666	0.000142533	0.00018454])
            30	mean([0.000216598	0.000373758	0.000239679])
            60	mean([0.000421287	0.000448	0.000267383])
            90	mean([0.000265336	0.000174096])
            120	mean([0.000239431	0.000251785	0.000122306])
            180	mean([0.000236795	0.00026879	0.000190533])
            240	mean([0.000181474	0.000236414	0.000224837])
            360	mean([0.000230462	0.000311202	0.000259051])
            ];
sigE_delmprA_std = [var([0.000138666	0.000142533	0.00018454])
            var([0.000216598	0.000373758	0.000239679])
            var([0.000421287	0.000448	0.000267383])
            var([0.000265336	0.000174096])
            var([0.000239431	0.000251785	0.000122306])
            var([0.000236795	0.00026879	0.000190533])
            var([0.000181474	0.000236414	0.000224837])
            var([0.000230462	0.000311202	0.000259051])
            ].^0.5;

% 4. mprA - activation - wildtype + delta sigE
        % wildtype
mprA_wt = [0	mean([0.000107017	0.000635933	0.000358923])
             30	mean([0.001568725	0.001968912	0.00240118])
            60	mean([0.003527778	0.002768	0.002196174])
            90	mean([0.003660204	0.003747088	0.003758893])
            120	mean([0.002284045	0.003534674	0.003450476])
            180	mean([0.004482783	0.003714286	0.003649012])
            240	mean([0.003646924	0.002357182	])
            360	mean([0.006696772	0.002765242	0.002411691])
            ];

mprA_wt_std = [var([0.000107017	0.000635933	0.000358923])
             var([0.001568725	0.001968912	0.00240118])
            var([0.003527778	0.002768	0.002196174])
            var([0.003660204	0.003747088	0.003758893])
            var([0.002284045	0.003534674	0.003450476])
            var([0.004482783	0.003714286	0.003649012])
            var([0.003646924	0.002357182	])
            var([0.006696772	0.002765242	0.002411691])
            ].^0.5;        

        % delta sigE
mprA_delsigE = [0	0.000312073	0.000280454	0.000199643
            30	0.001000075	0.000911407	0.00076849
            60	0.001373957	0.000697122	0.000912206
            90	0.000464723	0.000436862	0.000777589
            120	0.000596117	0.000870632	0.000626925
            180	0.000872495	0.000434759	0.000454975
            240	0.000592353	0.000583278	0.000374412
            360	0.000664586	0.000309622	0.000293906];
% 5. sigB - activation - wildtype + delta sigE
sigB_wt = [0	0.000220154	0.00081535	0.000608574
            30	0.005330677	0.005114236	0.006810619
            60	0.008755556	0.009369	0.0077151
            90	0.007736341	0.005703827	0.006038208
            120	0.006698795	0.006875667	0.006773322
            180	0.009561043	0.007242923	0.006606588
            240	0.003960842	0.006678318	0.00560346
            360	0.007145008	0.003701712	0.006222777];

sigB_delsigE = [0	3.38032E-05	3.22658E-05	2.08447E-05
        30	4.02291E-05	4.91578E-05	3.75251E-05
        60	4.58593E-05	5.15874E-05	5.60771E-05
        90	5.61017E-05	3.23072E-05	5.86268E-05
        120	5.24084E-05	5.26167E-05	6.77545E-05
        180	7.26045E-05	7.19089E-05	4.96278E-05
        240	7.35952E-05	7.56364E-05	3.71776E-05
        360	7.9184E-05	3.76217E-05	5.51642E-05];

% 6. sigB - activation - wildtype + delta mprA
        % wildtype
sigB_wt2 = [0	0.000589406	0.001348528	0.001359927
        30	0.014432948	0.011803549	0.009194567
        60	0.020138734	0.01165622	0.016813885
        90	0.021812904	0.01337154	0.012126834
        120	0.008972135	0.008286979	0.010402149
        180	0.013284697	0.01693197	0.013689207
        240	0.010207951	0.012809696	0.011621706
        360	0.01539611	0.009624152	0.012241535];

        % delta mprA
sigB_delmprA = [0	0.000655008	0.000795001	0.000937386
        30	0.000907363	0.001530824	0.001111906
        60	0.003944885	0.003041357	0.002472166
        90	0.001787386	0.001365407	0.001444067
        120	0.002539168	0.00271293	0.003439156
        180	0.003261644	0.003137152	0.003013367
        240	0.00329318	0.003279592	0.00490539
        360	0.003398909	0.005755299	0.005358893];

% 7. sigB - activation - wildtype + delta clgR
        % delta clgR
sigB_delclgR =[0	0.000123653	0.000155173	0.000171528
        30	0.002080381	0.002396167	0.002394772
        60	0.003355268	0.003477615	0.002877006
        90	0.001468329	0.003519796	0.002633795
        120	0.001774515	0.00158476	0.001457651
        180	0.000599187	0.000466589	0.000530604
        240	0.000301954	0.000205059	0.000179635
        360	0.00018624	0.000204701	0.000210161];
        % wildtype
sigB_wt3 = [0	0.000109137	0.000128349	0.00011468
        30	0.001088112	0.002540989	0.001476047
        60	0.001989466	0.003105085	0.002309134
        90	0.002478156	0.002470469	0.002787353
        120	0.001373324	0.002307117	0.001817823
        180	0.00212995	0.001711391	0.002012263
        240	0.00119979	0.001674457	0.001368587
        360	0.001075409	0.002178123	0.001161586];

% 8. sigE - dose response
    % activation
sigE_sds_inc = [0	0.000365846	0.000370666	0.00035555
        0.005	0.000342962	0.000634087	0.000428826
        0.01	0.000534025	0.000600447	0.000693618
        0.015	0.000718429	0.000699794	0.000814269
        0.02	0.001590816	0.001321662	0.001836502
        0.025	0.001887193	0.002087983	0.002499903
        0.03	0.003338119	0.0030246	0.004625368];
    % deactivation
sigE_sds_dec = [0.03	0.00252816	0.00342773	0.003684136
        0.025	0.002288718	0.002740816	0.002937222
        0.02	0.002162732	0.003203855	0.002409505
        0.015	0.001199079	0.002186655	0.001301759
        0.01	0.001610153	0.001970594	0.001981909
        0.005	0.001046203	0.000897676	0.00119236
        0	0.00090665	0.000876287	0.000927679];

%% expression data for smegmatis
% up down time course
smwtup_E = [0	0.913161575	0.824842324	0.560630536
10	6.146802412	6.696866198	6.817213023
30	4.354228806	4.064746199	4.90708561
60	5.213348357	5.572758845	4.949768069
120	7.61280615	6.572714742	4.619190968
180	6.697971819	4.640746769	3.467812388];

smwtdown_E = [0	4.28503778	6.436127906	7.750843817
10	1.875899199	1.368054051	1.059182212
30	0.414066049	0.450970045	0.440988028
60	0.424790196	0.284229341	0.389774766
120	0.555340481	0.235460074	0.157238899
180	0.576140024	0.595618316	0.590146702];

% doseresponse (sigE)
sm_dr_up = [0	0.423406376	0.50939612	0.182612766
0.0025	1.131310967	0.970625591	0.447376124
0.005	1.211184327	1.229331639	0.883332214
0.0075	2.826443338	2.125916848	1.323782327
0.01	3.56286859	2.759137899	1.083105225
0.015	6.521356703	2.71375367	3.18297498
0.02	8.646193774	6.551816484	2.437108766];

sm_dr_down = [0.02	8.848448393	6.141785678	4.515069347
0.015	3.485415142	4.786292053	2.099681098
0.01	1.80763212	1.176553288	0.923660166
0.0075	2.950799657	3.932442739	1.35430288
0.005	1.817565288	1.944936612	0.607663274
0.0025	0.397394948	1.363628585	0.452115529
0	0.576140024	0.595618316	0.590146702
];

% sigE in wt & delmpra
smwt_E = [0	8.83E-01	7.89E-01	6.24E-01
10	8.10E+00	6.80E+00	5.686157742
20	7.620607972	6.118528342	6.183863549
30	6.914567236	8.452441472	11.06636539
60	6.680773963	6.888629546	6.956501961
120	11.24684134	13.66985335	10.1840108
];

smmutA_E = [0	mean([0.341608746	0.394116114	0.394309286])
10	mean([0.813234605	1.295806275])
20	mean([0.68563333	0.728544055	0.823666241])
30	mean([0.456965469	0.554099227	0.472763773])
60	mean([0.593268353	0.636141479	0.431916572])
120	mean([0.160452266	0.445135931])
];
smmutA_E_std = [var([0.341608746	0.394116114	0.394309286])
var([0.813234605	1.295806275])
var([0.68563333	0.728544055	0.823666241])
var([0.456965469	0.554099227	0.472763773])
var([0.593268353	0.636141479	0.431916572])
var([0.160452266	0.445135931])
].^0.5;
% mprA in wt & delsigE
smwt_A = [0	0.154136156	0.195937776	0.17554705
10	0.457393288	0.310248621	0.317013481
20	0.367177367	0.498893811	0.3627643
30	0.247736483	0.321027256	0.397980821
60	0.314099942	0.25743465	0.41924204
120	0.32347569	0.533506229	0.402822301
];

smmutE_A = [0	mean([0.145199727	0.139946826	0.174545718])
10	mean([0.259694741	0.281205473])
20	mean([0.32376614	0.37307348	0.460016294])
30	mean([0.394804238	0.313508138	0.255505043])
60	mean([0.298121625	0.389424286	0.374417178])
120	mean([0.435724712	0.371158283	0.230794769])
];
smmutE_A_std = [var([0.145199727	0.139946826	0.174545718])
var([0.259694741	0.281205473])
var([0.32376614	0.37307348	0.460016294])
var([0.394804238	0.313508138	0.255505043])
var([0.298121625	0.389424286	0.374417178])
var([0.435724712	0.371158283	0.230794769])
].^0.5;

%% Figure for 2019 manuscript
run Rawdata_mprab_sigE_repeat2.m

figure; 

subplot(2,3,1)
errorbar(sm_dr_up(:,1), mean(sm_dr_up(:,2:4),2)/mean(sm_dr_up(1,2:4),2), std(sm_dr_up(:,2:4),'',2)/mean(sm_dr_up(1,2:4),2),'k-s');
hold on
errorbar(sm_dr_down(:,1), mean(sm_dr_down(:,2:4),2)/mean(sm_dr_up(1,2:4),2), std(sm_dr_down(:,2:4),'',2)/mean(sm_dr_up(1,2:4),2),'r-s')
xlabel('SDS [%w/v]'); ylabel('{\it sigE} mRNA (fold-change)')
ylim([0 25]); xlim([0 0.025])
legend('Increase','Decrease','location','northwest'); legend boxoff

subplot(2,3,2)
errorbar(smwt_A(:,1), mean(smwt_A(:,2:4),2)/mean(smwt_A(1,2:4),2), std(smwt_A(:,2:4),'',2)/mean(smwt_A(1,2:4),2),'k-s'); hold on
errorbar(smmutE_A(:,1), smmutE_A(:,2)/mean(smwt_A(1,2:4),2), smmutE_A_std/mean(smwt_A(1,2:4),2),'g-s');
xlabel('time (mins)'); ylabel('{\it mprA} mRNA (fold-change)')
legend('Wild-type','\Delta sigE','location','northwest'); legend boxoff
ylim([0 4]); xlim([0 150])

subplot(2,3,3);
errorbar(smwt_E(:,1), mean(smwt_E(:,2:4),2)/mean(smwt_E(1,2:4),2), std(smwt_E(:,2:4),'',2)/mean(smwt_E(1,2:4),2),'k-s'); hold on
errorbar(smmutA_E(:,1), smmutA_E(:,2)/mean(smwt_E(1,2:4),2), smmutA_E_std/mean(smwt_E(1,2:4),2),'g-s');
xlabel('time (mins)'); ylabel('{\it sigE} mRNA (fold-change)')
legend('Wild-type','\Delta mprA','location','northwest'); legend boxoff
ylim([0 25]); xlim([0 150])

subplot(2,3,4)
    errorbar(sigE_sds_inc3(:,1),mean(sigE_sds_inc3(:,2:4),2)/mean(sigE0),std(sigE_sds_inc3(:,2:4),'',2)/mean(sigE0),'k-^'); hold on
    errorbar(sigE_sds_dec3(:,1),mean(sigE_sds_dec3(:,2:4),2)/mean(sigE0),std(sigE_sds_dec3(:,2:4),'',2)/mean(sigE0),'r-^')
ylabel('{\it sigE} mRNA (fold-change)'); xlabel('SDS [%w/v]'); 
xlim([-0.002 0.032]); ylim([0 15])
subplot(2,3,5)
    errorbar(mprA_0_30(:,1),mean(mprA_0_30(:,2:4),2)/mean(mprA0),std(mprA_0_30(:,2:4),'',2)/mean(mprA0),'k-^'); hold on
    errorbar(mprA_delsigE(1:5,1), mean(mprA_delsigE(1:5,2:4),2)/mean(mprA_delsigE(1,2:4),2), std(mprA_delsigE(1:5,2:4),'',2)/mean(mprA_delsigE(1,2:4),2),'g-^');
ylabel('{\it mprA} mRNA (fold-change)'); xlabel('time (mins)'); 
subplot(2,3,6)
    errorbar(sigE_0_30(:,1),mean(sigE_0_30(:,2:4),2)/mean(sigE0),std(sigE_0_30(:,2:4),'',2)/mean(sigE0),'k-^'); hold on
    errorbar(sigE_delmprA(1:5,1), sigE_delmprA(1:5,2)/sigE_delmprA(1,2), sigE_delmprA_std(1:5)/sigE_delmprA(1,2),'g-^');
ylabel('{\it sigE} mRNA (fold-change)'); xlabel('time (mins)'); 
set(findobj(gcf,'type','axes'),'FontName','Arial','FontSize',13, ...
'LineWidth', 1,'layer','top');


%% long time scale sige SDS down

% midlog( Unstressed)		
sige_unstressed = [0.009219592	0.018524991	0.009042672	0.004379426	0.00618309];
sige_003_2h = [0.113937652	0.079252477	0.081378108];
sige_003_24h = [0.011746177	0.014388816	0.01455224];
											
											
%After 2hrs of SDS stress, cells were pelleted down & resuspended in SDS free worm medium.										sigE/16S	
sige_003_0_tdown = [0 2 4 24]; %hrs
sige_003_0_down = [0.113937652	0.079252477	0.081378108
0.019472907	0.015222279	0.012362565
0.01601777	0.012741425	0.014336406
0.007044369	0.007669168	0.007095652];

sige0 = mean(sige_unstressed);
std(sige_unstressed)

figure(1)
errorbar(sige_003_0_tdown*60, mean(sige_003_0_down,2)/sige0, std(sige_003_0_down,'',2)/sige0)
hold on;
errorbar(sigE_30_0(:,1),mean(sigE_30_0(:,2:4),2)/mean(sigE0),std(sigE_30_0(:,2:4),'',2)/mean(sigE0),'r^')

xlabel('time(min)')
ylabel('sigE mRNA (fold)');
title('sigE mRNA: 0.03 --> 0')
legend('0.03 \rightarrow 0: long time','0.03 \rightarrow 0: short time')
